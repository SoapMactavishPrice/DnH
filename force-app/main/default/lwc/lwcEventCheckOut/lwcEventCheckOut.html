<template>
    <lightning-card>
        <!--  -->
        <div class="wrapper">

            <div class="form">
                <div style="text-align: center; padding: 10px;">
                    <h1 class="slds-p-bottom_large" style="text-align: center;font-weight:800; font-size:medium">
                        <u>Check-Out
                            Details</u>
                    </h1>
                </div>

                <div class="inputfield">
                    <label>Visit Result</label>
                    <lightning-textarea class="slds-p-around_medium input" value={Visit_Result__c}
                        data-id="Visit_Result__c" onchange={handleInputChange} variant="label-hidden">
                    </lightning-textarea>
                </div>
                <div class="inputfield">
                    <label>Visit Description</label>
                    <lightning-textarea type="Text" class="slds-p-around_medium input" value={Description}
                        data-id="Description" onchange={handleInputChange} variant="label-hidden">
                    </lightning-textarea>
                </div>
                <div class="inputfield">
                    <label>Client Feedback Or Insights</label>
                    <lightning-textarea class="slds-p-around_medium input" value={Client_Feedback_Or_Insights__c}
                        data-id="Client_Feedback_Or_Insights__c" onchange={handleInputChange} variant="label-hidden">
                    </lightning-textarea>
                </div>
                <div class="inputfield">
                    <label>Action To Do</label>
                    <lightning-textarea class="slds-p-around_medium input" value={Action_To_Do__c}
                        data-id="Action_To_Do__c" onchange={handleInputChange} variant="label-hidden">
                    </lightning-textarea>
                </div>
                <div class="slds-p-around_medium">
            <!-- Dynamic Rows -->
            <lightning-card   title="Meeting Details" icon-name="standard:event" if:true={isHide}>
                <template for:each={rows} for:item="row" for:index="index">
                    <div class="slds-grid slds-wrap slds-m-bottom_small custom-card slds-p-around_medium " key={row.id}>
                        <!-- Contact Type Selection -->
                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small">
                            <lightning-record-edit-form object-api-name="Meeting_Attendee__c" >
                            <p>Select Contact Type</p>
                            <!-- Start Date Time -->
                            <lightning-input-field field-name="Contact_Type__c" variant="label-hidden" value={row.contactType} onchange={handleContactType} 
                                data-id={row.id}
                                data-field="contactType"
                                data-index={index}></lightning-input-field>
                             </lightning-record-edit-form>
                        </div>

                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small" if:true={row.isNew}>
                            <lightning-record-edit-form object-api-name="Meeting_Attendee__c" >
                            <p>First Name</p>
                            <!-- Start Date Time -->
                            <lightning-input-field field-name="First_Name__c" variant="label-hidden" value={row.firstName} onchange={handleTableStandardInputChange} 
                                data-id={row.id}
                                data-field="firstName"
                                data-index={index}></lightning-input-field>
                             </lightning-record-edit-form>
                        </div>
                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small" if:true={row.isNew}>
                            <lightning-record-edit-form object-api-name="Meeting_Attendee__c" >
                            <p>Last Name</p>
                            <!-- Start Date Time -->
                            <lightning-input-field field-name="Last_Name__c" variant="label-hidden" value={row.lastName} onchange={handleTableStandardInputChange} 
                                data-id={row.id}
                                data-field="lastName"
                                data-index={index}></lightning-input-field>
                             </lightning-record-edit-form>
                        </div>
                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small" if:true={row.isNew}>
                            <lightning-record-edit-form object-api-name="Meeting_Attendee__c" >
                            <p>Mobile</p>
                            <!-- Start Date Time -->
                            <lightning-input-field field-name="Mobile__c" variant="label-hidden" value={row.Mobile} onchange={handleTableStandardInputChange} 
                                data-id={row.id}
                                data-field="Mobile"
                                data-index={index}></lightning-input-field>
                             </lightning-record-edit-form>
                        </div>

                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small" if:true={row.isNew}>
                            <lightning-record-edit-form object-api-name="Meeting_Attendee__c" >
                            <p>Email</p>
                            <!-- Start Date Time -->
                            <lightning-input-field field-name="Email__c" variant="label-hidden" value={row.Email__c} onchange={handleTableStandardInputChange} 
                                data-id={row.id}
                                data-field="Email"
                                data-index={index}></lightning-input-field>
                             </lightning-record-edit-form>
                        </div>

                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small" if:true={row.isNew}>
                            <lightning-record-edit-form object-api-name="Meeting_Attendee__c" >
                            <p>Department</p>
                            <!-- Start Date Time -->
                            <lightning-input-field field-name="Department__c" variant="label-hidden" value={row.departmentId} onchange={handleDepartmenChange} 
                                data-id={row.id}
                                data-field="departmentId"
                                data-index={index}></lightning-input-field>
                             </lightning-record-edit-form>
                        </div>

                        <!-- Contact Selection -->
                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small" if:true={row.isExisting}>
                            <lightning-combobox
                                name="contact"
                                label="Contact"
                                placeholder="Select a Contact"
                                value={row.contact}
                                options={contactOptions}
                                data-id={row.id}
                                onchange={handleContactInput}
                                data-index={index}>
                            </lightning-combobox>
                        </div>

                        <!-- Department -->
                        <div class="slds-col slds-size_12-of-12 slds-medium-size_3-of-12 slds-p-horizontal_x-small" if:true={row.isExisting}>
                            <lightning-input
                                type="text"
                                label="Department"
                                value={row.department}
                                data-id={row.id}
                                data-field="department"
                                onchange={handleTableInputChange}
                                disabled>
                            </lightning-input>
                        </div>
                        <div class="slds-col slds-size_12-of-12 slds-medium-size_2-of-12 slds-p-horizontal_x-small" if:true={row.contactType}>
                            <lightning-input
                                type="date"
                                label="Next Follow-up Date"
                                value={row.followUpDate}
                                data-id={row.id}
                                data-field="followUpDate"
                                onchange={handleTableInputChange}>
                            </lightning-input>
                        </div>

                        <!-- Meeting Description -->
                        <div class="slds-col slds-size_12-of-12 slds-medium-size_9-of-12 slds-p-horizontal_x-small" if:true={row.contactType}>
                            <lightning-textarea
                                label="Meeting Description"
                                placeholder="Enter meeting details"
                                value={row.description}
                                data-id={row.id}
                                data-field="description"
                                onchange={handleTableInputChange}>
                            </lightning-textarea>
                        </div>

                        <!-- Next Follow-up Date -->
                        

                        <!-- Remove Row Button -->
                        <div class="slds-col slds-size_4-of-12 slds-medium-size_1-of-12 slds-align_absolute-center slds-p-horizontal_x-small">
                            <lightning-button
                                icon-name="utility:close"
                                label="Remove"
                                onclick={removeRow}
                                data-id={row.id}
                                variant="base"
                                size="small">
                            </lightning-button>
                        </div>
                    </div>
                </template>
            </lightning-card>

            <!-- Add Row Button -->
            <div class="slds-m-top_medium slds-text-align_right">
                <lightning-button
                    label="Add Row"
                    icon-name="utility:add"
                    variant="neutral"
                    onclick={addRow}
                    if:true={isHide}>
                </lightning-button>
            </div>
        </div>
                <div style="text-align: center; padding: 10px;">
                    <lightning-button class="slds-p-left_large" label="Cancel" onclick={handleReset}></lightning-button>
                    <lightning-button class="slds-p-left_large" variant="brand" label="Check Out"
                        onclick={handleSave}></lightning-button>
                </div>
            </div>
        </div>
    </lightning-card>
    
   
</template>